import{_ as De}from"./AppDateTimePicker-ac3367e2.js";import{V as ke,_ as xe,a as we,b as Se}from"./VPagination-03ce6bd5.js";import{_ as Ie}from"./AppTextField-314f8b07.js";import{_ as Ve}from"./DialogCloseBtn-794368e9.js";import{a as T}from"./axios-f66e6075.js";import{V as G,d as M,a as he,b as ce,c as Ue}from"./VCard-6740f87f.js";import{V as N,a as V}from"./VRow-8854109f.js";import{a as me,m as Pe,b as $e,u as Be,c as pe,f as Fe,d as Ae,e as Re,V as ze}from"./VTextField-2ef22c52.js";import{a1 as K,K as P,j as f,a2 as ye,o as ue,b as be,w as a,n as e,p as t,C as x,Q as F,E as A,x as H,G as Le,a3 as Te,a4 as je,U as Ne,a5 as fe,D as Me,J as qe,a6 as Ee,L as le,F as oe,a7 as Oe,a8 as Ke,l as J,M as Ye,a9 as Ge,N as He,c as Je,aa as Qe,z as ne,r as ge}from"./index-02544f79.js";import{V as re}from"./VDialog-9c788e32.js";import{f as We}from"./forwardRefs-9d31fcaa.js";import{a as Ce,V as se}from"./VSelect-8d7f4e6e.js";import{t as Xe,h as ve,i as Ze,j as ea,f as aa,A as ie}from"./auth-6f82e049.js";import{V as _e}from"./VSpacer-789f9cb5.js";import"./VOverlay-311e958b.js";import"./transition-11e3056b.js";import"./VCheckboxBtn-377a9031.js";import"./VList-2da4db40.js";import"./VAvatar-8d8c7504.js";import"./VImg-71aa10cb.js";import"./VDivider-883477ee.js";import"./dialog-transition-2ccf56f1.js";import"./VMenu-d75f87ea.js";const ta={__name:"CreateDialog",props:{isDialogVisible:{type:Boolean,required:!1},isUpdate:{type:Boolean,required:!0},campaign:{type:Object,required:!0},categories:{type:Array,required:!0},sub_categories:{type:Array,required:!0}},emits:["close-dialog"],setup(i,{emit:y}){const b=i,g=K(b,"isDialogVisible"),l=K(b,"campaign"),v=K(b,"categories"),p=K(b,"sub_categories"),w=P(()=>{const u=l.value.category;return p.value.filter(n=>n.parent==u)}),S=P(()=>m.value.length>0),m=f(""),_=()=>{y("close-dialog",!1)},C=()=>{const u=l.value;if(u.name.length==0){m.value="Campaign Name must be not empty.";return}if(u.company.length==0){m.value="Company must be not empty.";return}if(u.category.length==0){m.value="Category must be not empty.";return}if(u.sub_category.length==0){m.value="Sub Category must be not empty.";return}if(u.start_date.length==0){m.value="You must select start date.";return}if(u.end_date.length==0){m.value="You must select end date.";return}if(u.status!="active"&&u.status!="inactive"){m.value="Status is wrong.";return}u.start_date=new Date(u.start_date).toISOString().slice(0,19).replace("T"," "),u.end_date=new Date(u.end_date).toISOString().slice(0,19).replace("T"," "),u.category=v.value.find(n=>n.value==u.category).title,u.sub_category=p.value.find(n=>n.value==u.sub_category).title,b.isUpdate?T.put("/admin/campaigns",u).then(n=>{y("close-dialog",!0)}):T.post("/admin/campaigns",u).then(n=>{y("close-dialog",!0)})};return ye(()=>{v.length>0&&(l.value.category=v[0].value)}),(u,n)=>{const B=Ve,h=Ie,U=xe,I=De;return ue(),be(re,{modelValue:t(g),"onUpdate:modelValue":n[9]||(n[9]=c=>A(g)?g.value=c:null),"max-width":"720"},{default:a(()=>[e(B,{onClick:_}),e(G,{title:"Campaign Detail"},{default:a(()=>[e(M,{class:"px-8"},{default:a(()=>[e(N,{class:"mt-4"},{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).name,"onUpdate:modelValue":n[0]||(n[0]=c=>t(l).name=c),label:"Campaign Name"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).company,"onUpdate:modelValue":n[1]||(n[1]=c=>t(l).company=c),label:"Company"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(U,{modelValue:t(l).category,"onUpdate:modelValue":n[2]||(n[2]=c=>t(l).category=c),items:t(v),label:"Category"},null,8,["modelValue","items"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(U,{modelValue:t(l).sub_category,"onUpdate:modelValue":n[3]||(n[3]=c=>t(l).sub_category=c),items:t(w),label:"Sub Category"},null,8,["modelValue","items"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(me,{for:"start-date",class:"mb-1 text-body-2 text-high-emphasis"},{default:a(()=>[x(" Start Date ")]),_:1}),e(I,{id:"end-date",class:"mr-4",modelValue:t(l).start_date,"onUpdate:modelValue":n[4]||(n[4]=c=>t(l).start_date=c)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(me,{for:"end-date",class:"mb-1 text-body-2 text-high-emphasis"},{default:a(()=>[x(" End Date ")]),_:1}),e(I,{class:"mr-4",modelValue:t(l).end_date,"onUpdate:modelValue":n[5]||(n[5]=c=>t(l).end_date=c)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).today_sales,"onUpdate:modelValue":n[6]||(n[6]=c=>t(l).today_sales=c),label:"Today Sales",type:"number"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).total_sales,"onUpdate:modelValue":n[7]||(n[7]=c=>t(l).total_sales=c),label:"Total Sales",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(M,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[e(F,{variant:"tonal",color:"secondary",onClick:_},{default:a(()=>[x(" Close ")]),_:1}),e(F,{onClick:C},{default:a(()=>[x(" Save ")]),_:1})]),_:1})]),_:1}),e(ke,{modelValue:t(S),"onUpdate:modelValue":n[8]||(n[8]=c=>A(S)?S.value=c:null),timeout:1e3,location:"top end",color:"error"},{default:a(()=>[x(H(t(m)),1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}};const la=Le()({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:i=>typeof i=="boolean"||[1e3,1024].includes(i)},...Pe({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:i=>Te(i).every(y=>y!=null&&typeof y=="object")},...$e({clearable:!0})},emits:{"click:control":i=>!0,"mousedown:control":i=>!0,"update:focused":i=>!0,"update:modelValue":i=>!0},setup(i,y){let{attrs:b,emit:g,slots:l}=y;const{t:v}=je(),p=Ne(i,"modelValue"),{isFocused:w,focus:S,blur:m}=Be(i),_=P(()=>typeof i.showSize!="boolean"?i.showSize:void 0),C=P(()=>(p.value??[]).reduce((d,D)=>{let{size:R=0}=D;return d+R},0)),u=P(()=>fe(C.value,_.value)),n=P(()=>(p.value??[]).map(d=>{const{name:D="",size:R=0}=d;return i.showSize?`${D} (${fe(R,_.value)})`:D})),B=P(()=>{var D;const d=((D=p.value)==null?void 0:D.length)??0;return i.showSize?v(i.counterSizeString,d,u.value):v(i.counterString,d)}),h=f(),U=f(),I=f();function c(){var d;I.value!==document.activeElement&&((d=I.value)==null||d.focus()),w.value||S()}function Q(d){q(d)}function Y(d){g("mousedown:control",d)}function q(d){var D;(D=I.value)==null||D.click(),g("click:control",d)}function W(d){d.stopPropagation(),c(),Oe(()=>{p.value=[],Ke(i["onClick:clear"],d)})}return Me(p,d=>{(!Array.isArray(d)||!d.length)&&I.value&&(I.value.value="")}),qe(()=>{const d=!!(l.counter||i.counter),D=!!(d||l.details),[R,X]=Ee(b),[{modelValue:de,...Z}]=pe.filterProps(i),[ee]=Fe(i);return e(pe,le({ref:h,modelValue:p.value,"onUpdate:modelValue":z=>p.value=z,class:["v-file-input",i.class],style:i.style,"onClick:prepend":Q},R,Z,{focused:w.value}),{...l,default:z=>{let{id:j,isDisabled:L,isDirty:E,isReadonly:ae,isValid:te}=z;return e(Ae,le({ref:U,"prepend-icon":i.prependIcon,onMousedown:Y,onClick:q,"onClick:clear":W,"onClick:prependInner":i["onClick:prependInner"],"onClick:appendInner":i["onClick:appendInner"]},ee,{id:j.value,active:E.value||w.value,dirty:E.value,disabled:L.value,focused:w.value,error:te.value===!1}),{...l,default:r=>{var k;let{props:{class:s,...$}}=r;return e(oe,null,[e("input",le({ref:I,type:"file",readonly:ae.value,disabled:L.value,multiple:i.multiple,name:i.name,onClick:o=>{o.stopPropagation(),c()},onChange:o=>{if(!o.target)return;const O=o.target;p.value=[...O.files??[]]},onFocus:c,onBlur:m},$,X),null),e("div",{class:s},[!!((k=p.value)!=null&&k.length)&&(l.selection?l.selection({fileNames:n.value,totalBytes:C.value,totalBytesReadable:u.value}):i.chips?n.value.map(o=>e(Ce,{key:o,size:"small",color:i.color},{default:()=>[o]})):n.value.join(", "))])])}})},details:D?z=>{var j,L;return e(oe,null,[(j=l.details)==null?void 0:j.call(l,z),d&&e(oe,null,[e("span",null,null),e(Re,{active:!!((L=p.value)!=null&&L.length),value:B.value},l.counter)])])}:void 0})}),We({},h,U,I)}}),oa=J("b",null,"Campaign: ",-1),na={class:"ml-2 text-success"},sa={__name:"ImportDialog",props:{isDialogVisible:{type:Boolean,required:!0},campaign:{type:Object,required:!0}},emits:["close-dialog"],setup(i,{emit:y}){const b=i,g=K(b,"isDialogVisible"),l=f(!1),v=f(null),p=()=>{y("close-dialog")},w=()=>{const m=b.campaign;if(!m.id)return;const _=v.value;if(_.length==0)return;l.value=!0;const C=new FormData;C.append("csv",_[0]),T.post(`/admin/campaigns/${m.id}/import`,C,{headers:{"Content-Type":"multipart/form-data"}}).then(u=>{S()}).catch(u=>{S()})},S=()=>{l.value=!1,p()};return(m,_)=>{const C=Ve;return ue(),be(re,{modelValue:t(g),"onUpdate:modelValue":_[1]||(_[1]=u=>A(g)?g.value=u:null),"max-width":"600"},{default:a(()=>[e(C,{onClick:p}),e(G,{title:"Import Campaign Detail Data"},{default:a(()=>[e(M,{class:"px-8"},{default:a(()=>[e(N,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[oa,J("span",na,H(b.campaign.name),1)]),_:1})]),_:1}),e(N,{class:"mt-4"},{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(la,{accept:"text/csv",label:"Select Import File(csv)",multiple:!1,modelValue:t(v),"onUpdate:modelValue":_[0]||(_[0]=u=>A(v)?v.value=u:null)},null,8,["modelValue"])]),_:1})]),_:1}),Ye(e(N,{class:"mt-4"},{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(Ge,{indeterminate:"",color:"primary"})]),_:1})]),_:1},512),[[He,t(l)]])]),_:1}),e(M,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[e(F,{variant:"tonal",color:"secondary",onClick:p},{default:a(()=>[x(" Close ")]),_:1}),e(F,{onClick:w},{default:a(()=>[x(" Import Data ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const ia=J("div",{class:"mb-2"}," Filter: ",-1),ua={class:"d-flex gap-1"},Ba={__name:"index",setup(i){const y=f([]),b=f([]),g=f(Xe),l=f(!1),v=f(!1),p=f(!1),w=f(!1),S=f(ve),m=f(),_=f(),C=f(),u=f([]),n=f([]),B=f(-1),h=f({}),U={value:-1,title:ie,parent:-1},I=P(()=>m.value==null?[]:n.value.filter(r=>r.parent==m.value)),c=P(()=>[U,...u.value]),Q=P(()=>(_.value=U.value,[U,...I.value])),Y=r=>r==="active"?{color:"primary",text:"Active"}:r==="inactive"?{color:"secondary",text:"Inactive"}:{color:"secondary",text:"Inactive"},q=r=>r.map(s=>({value:s.id,title:s.name,parent:s.parent_id})),W=r=>u.value.find(s=>s.value==r),d=r=>n.value.find(s=>s.value==r),D=()=>{l.value=!0,w.value=!1},R=r=>{l.value=!1,S.value=ve,r&&E()},X=r=>{S.value=r,l.value=!0,w.value=!0},de=r=>{v.value=!0,B.value=r},Z=()=>{v.value=!1,B.value=-1},ee=r=>{p.value=!0,h.value=r},z=()=>{p.value=!1},j=r=>{T.put(`/admin/campaigns/activate/${r}`).then(s=>{const{campaigns:$}=s.data;y.value=$,b.value=$})},L=()=>{T.delete(`/admin/campaigns/${B.value}`).then(r=>{const{campaigns:s}=r.data;y.value=s,v.value=!1,B.value=-1})},E=()=>{T.get("/admin/campaigns").then(r=>{const{campaigns:s}=r.data;y.value=s,b.value=s})},ae=()=>{T.get("/admin/campaign-categories").then(r=>{const{data:s}=r.data;u.value=q(s.categories),n.value=q(s.sub_categories),m.value=U.value,C.value=ie})},te=()=>{const r=m.value,s=_.value,$=C.value;let k=[...y.value];r!=-1&&(k=k.filter(o=>o.category==W(r).title),s!=-1&&(k=k.filter(o=>o.sub_category==d(s).title))),$!=ie&&(k=k.filter(o=>o.status==$)),b.value=k};return ye(()=>{ae(),E()}),(r,s)=>{const $=ge("RouterLink"),k=ge("IconBtn");return ue(),Je("div",null,[e(G,null,{default:a(()=>[e(he,null,Qe({default:a(()=>[e(ce,null,{default:a(()=>[x("Campaign List")]),_:1})]),_:2},[t(Ze)()?{name:"append",fn:a(()=>[e(F,{size:"small",icon:"tabler-plus",onClick:D})]),key:"0"}:void 0]),1024),e(M,null,{default:a(()=>[ia,e(N,{class:"mb-3 mx-4"},{default:a(()=>[e(V,null,{default:a(()=>[e(se,{items:t(c),modelValue:t(m),"onUpdate:modelValue":s[0]||(s[0]=o=>A(m)?m.value=o:null),label:"Category"},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:a(()=>[e(se,{items:t(Q),modelValue:t(_),"onUpdate:modelValue":s[1]||(s[1]=o=>A(_)?_.value=o:null),label:"Sub Category"},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:a(()=>[e(se,{items:t(ea),modelValue:t(C),"onUpdate:modelValue":s[2]||(s[2]=o=>A(C)?C.value=o:null),label:"Status"},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:a(()=>[e(F,{block:"",onClick:te},{default:a(()=>[x(" Apply ")]),_:1})]),_:1})]),_:1}),e(t(we),{headers:t(aa).campaign,items:t(b),"items-per-page":t(g).itemsPerPage,page:t(g).page,"onUpdate:options":s[5]||(s[5]=o=>g.value=o)},{"item.name":a(({item:o})=>[e($,{to:`/campaigns/${o.raw.id}`,class:"link d-flex align-center gap-x-3"},{default:a(()=>[x(H(o.raw.name),1)]),_:2},1032,["to"])]),"item.status":a(({item:o})=>[e(Ce,{color:Y(o.raw.status).color,onClick:O=>j(o.raw.id),class:"font-weight-medium",size:"small"},{default:a(()=>[x(H(Y(o.raw.status).text),1)]),_:2},1032,["color","onClick"])]),"item.actions":a(({item:o})=>[J("div",ua,[e(k,{onClick:O=>X(o.raw)},{default:a(()=>[e(ne,{icon:"mdi-pencil-outline"})]),_:2},1032,["onClick"]),e(k,{onClick:O=>ee(o.raw)},{default:a(()=>[e(ne,{icon:"tabler-arrow-big-up-lines"})]),_:2},1032,["onClick"]),e(k,{onClick:O=>de(o.raw.id)},{default:a(()=>[e(ne,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"])])]),bottom:a(()=>[e(M,{class:"mt-8"},{default:a(()=>[e(N,null,{default:a(()=>[e(V,{lg:"2",cols:"3"},{default:a(()=>[e(ze,{modelValue:t(g).itemsPerPage,"onUpdate:modelValue":s[3]||(s[3]=o=>t(g).itemsPerPage=o),label:"Rows per page:",type:"number",min:"-1",max:"15","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{lg:"10",cols:"9",class:"d-flex justify-end"},{default:a(()=>[e(Se,{modelValue:t(g).page,"onUpdate:modelValue":s[4]||(s[4]=o=>t(g).page=o),"total-visible":"5",length:Math.ceil(t(y).length/t(g).itemsPerPage)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1},8,["headers","items","items-per-page","page"])]),_:1})]),_:1}),e(ta,{isDialogVisible:t(l),campaign:t(S),categories:t(u),sub_categories:t(n),isUpdate:t(w),onCloseDialog:R},null,8,["isDialogVisible","campaign","categories","sub_categories","isUpdate"]),e(sa,{isDialogVisible:t(p),campaign:t(h),onCloseDialog:z},null,8,["isDialogVisible","campaign"]),e(re,{modelValue:t(v),"onUpdate:modelValue":s[6]||(s[6]=o=>A(v)?v.value=o:null),"max-width":"500px"},{default:a(()=>[e(G,null,{default:a(()=>[e(ce,{class:"px-8 py-8"},{default:a(()=>[x(" Are you sure you want to delete this campaign? ")]),_:1}),e(Ue,null,{default:a(()=>[e(_e),e(F,{color:"error",variant:"outlined",onClick:Z},{default:a(()=>[x(" Cancel ")]),_:1}),e(F,{color:"success",variant:"elevated",onClick:L},{default:a(()=>[x(" OK ")]),_:1}),e(_e)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Ba as default};
